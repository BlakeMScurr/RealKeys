import{S as s,i as t,s as e,M as a,e as o,t as r,a as n,k as i,c as l,b as c,d as m,g as d,f as h,l as f,m as p,h as u,j as g,q as v,w as $,K as y,v as b,y as k,A as j,B as w,J as I,L as E,N as H,E as C,n as D}from"./client.5ee8e5bf.js";import{L as x}from"./Loader.c9c5d5f1.js";import{P as M,n as T}from"./instrument.c8f15cd3.js";import{b as V,n as K}from"./notes.be99bc8d.js";import{s as L,i as N}from"./storage.4617e2a9.js";import"./webmidi.min.0a3878e3.js";import"./_commonjsHelpers.521bc219.js";function P(s){let t,e,a,i,f,v;return{c(){t=o("div"),e=o("h3"),a=r("Setup complete"),i=n(),f=o("img"),this.h()},l(s){t=l(s,"DIV",{class:!0});var o=c(t);e=l(o,"H3",{});var r=c(e);a=m(r,"Setup complete"),r.forEach(d),i=h(o),f=l(o,"IMG",{src:!0,alt:!0}),o.forEach(d),this.h()},h(){f.src!==(v="/Tick.png")&&p(f,"src","/Tick.png"),p(f,"alt","tick"),p(t,"class","titleHolder svelte-18khiw")},m(s,o){u(s,t,o),g(t,e),g(e,a),g(t,i),g(t,f)},i:D,o:D,d(s){s&&d(t)}}}function S(s){let t,e,a,y,j,w;return j=new x({props:{text:"Waiting for middle C"}}),{c(){t=o("div"),e=o("h3"),a=r("Play middle C on your MIDI keyboard to test the connection"),y=n(),i(j.$$.fragment),this.h()},l(s){t=l(s,"DIV",{class:!0});var o=c(t);e=l(o,"H3",{});var r=c(e);a=m(r,"Play middle C on your MIDI keyboard to test the connection"),r.forEach(d),y=h(o),f(j.$$.fragment,o),o.forEach(d),this.h()},h(){p(t,"class","titleHolder svelte-18khiw")},m(s,o){u(s,t,o),g(t,e),g(e,a),g(t,y),v(j,t,null),w=!0},i(s){w||(b(j.$$.fragment,s),w=!0)},o(s){$(j.$$.fragment,s),w=!1},d(s){s&&d(t),k(j)}}}function G(s){let t,e,j,w,I,H,C,D,x,T;const L=[S,P],N=[];function G(s,t){return s[1]?1:0}return I=G(s),H=N[I]=L[I](s),x=new M({props:{lessonNotes:new Map([[V("C",4),"expecting"]]),keys:K(V("G",3),V("C",5)),instrument:s[0],sandbox:!0,midiOnly:!0}}),x.$on("playingNotes",(function(){a(s[2])&&s[2].apply(this,arguments)})),{c(){t=o("div"),e=o("h2"),j=r("Test Keyboard"),w=n(),H.c(),C=n(),D=o("div"),i(x.$$.fragment),this.h()},l(s){t=l(s,"DIV",{class:!0});var a=c(t);e=l(a,"H2",{});var o=c(e);j=m(o,"Test Keyboard"),o.forEach(d),w=h(a),H.l(a),C=h(a),D=l(a,"DIV",{class:!0});var r=c(D);f(x.$$.fragment,r),r.forEach(d),a.forEach(d),this.h()},h(){p(D,"class","pianoHolder svelte-18khiw"),p(t,"class","vert svelte-18khiw")},m(s,a){u(s,t,a),g(t,e),g(e,j),g(t,w),N[I].m(t,null),g(t,C),g(t,D),v(x,D,null),T=!0},p(e,[a]){let o=I;I=G(s=e),I!==o&&(E(),$(N[o],1,1,()=>{N[o]=null}),y(),H=N[I],H||(H=N[I]=L[I](s),H.c()),b(H,1),H.m(t,C));const r={};1&a&&(r.instrument=s[0]),x.$set(r)},i(s){T||(b(H),b(x.$$.fragment,s),T=!0)},o(s){$(H),$(x.$$.fragment,s),T=!1},d(s){s&&d(t),N[I].d(),k(x)}}}function q(s,t,e){const{session:a}=j();let o;w(()=>{e(0,o=T("tester",()=>{console.log("piano loaded")}))});let r=!1,n=s=>{if(!r){s.detail.includes(V("C",4))&&(e(1,r=!0),L(N.midi),setTimeout(()=>{let s=H(a);s&&void 0!==s.redirect?(a.set({}),C(s.redirect)):C("/settings")},500))}};return I(()=>{e(2,n=()=>{})}),[o,r,n]}export default class extends s{constructor(s){super(),t(this,s,q,G,e,{})}}
